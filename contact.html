<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact — GeoConsultants</title>
  <link rel="stylesheet" href="/assets/css/site.css">
</head>
<body>
  <div data-include="/partials/header.html"></div>

  <main class="page">
    <section class="form-card">
      <h2>Contact GeoConsultants</h2>
      <form id="contactForm" novalidate>
        <input type="text" name="name" placeholder="Your Name" required>
        <input type="email" name="email" placeholder="Your Email" required>
        <textarea name="message" rows="5" placeholder="Your Message" required></textarea>
        <button type="submit">Send Message</button>
        <p id="formMessage"></p>
      </form>
    </section>
  </main>

  <div data-include="/partials/footer.html"></div>

  <!-- Include loader + active nav highlighter -->
  <script>
  (async function () {
    const parts = document.querySelectorAll('[data-include]');
    await Promise.all([...parts].map(async el => {
      const url = el.getAttribute('data-include');
      const res = await fetch(url, { cache: 'no-cache' });
      el.innerHTML = await res.text();
    }));
    const path = location.pathname.replace(/\/+$/, '') || '/index.html';
    const current = path.endsWith('/contact.html') ? 'contact' : 'home';
    document.querySelectorAll('[data-nav]').forEach(a => {
      if (a.dataset.nav === current) a.classList.add('active');
    });
  })();

  // Contact form submit handler
  document.addEventListener('submit', async (e) => {
    const form = e.target;
    if (form.id !== 'contactForm') return;
    e.preventDefault();

    const data = {
      name: form.name.value.trim(),
      email: form.email.value.trim(),
      message: form.message.value.trim()
    };

    const msg = document.getElementById('formMessage');
    msg.textContent = '⏳ Sending...';
    msg.style.color = '#ccc';

    try {
      const response = await fetch('https://send-contact-form.valakosd.workers.dev', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await response.json();

      if (result.success) {
        msg.textContent = '✅ Message sent successfully!';
        msg.style.color = '#50fa7b';
        form.reset();
      } else {
        msg.textContent = '❌ Error sending message. Please try again later.';
        msg.style.color = '#ff5555';
      }
    } catch (err) {
      msg.textContent = '⚠️ Network error. Please try again later.';
      msg.style.color = '#ff5555';
    }
  });
  </script>
</body>
</html>
